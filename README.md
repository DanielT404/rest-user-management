Hello World! Lorem ipsum dolor sit amet.

![Windows_vs_Linux](https://itsfoss.com/wp-content/uploads/2013/07/Windows_Vs_Mac_Vs_Linux_10.jpg)

## How to run the user service

1. `git clone https://github.com/DanielT404/rest-user-management.git` to your own path of choice.
2. Wanna test it out without having to install the dependencies locally? Just run `docker-compose -f development.no-hotreload.docker-compose.yml up --build -d`.
3. Run `docker-compose -f development.no-hotreload.docker-compose.yml logs` to get some insightful information from the containers ;-).
4. App is now ready to handle incoming requests on port 3000.

## Database used

MongoDB.

## User schema

An user is stored in the database with the following fields:

- \_id: 12-byte string to uniquely identify a record, generated by MongoDB.
- username: string, unique, UTF-8 encoded
- hash: 64-byte string, unique (96.83% probably, nothing is perfect), hex encoded, representing the encryption of the plain-text user password and a random salt, using the `scrypt` function from `crypto` built-in node module.
- salt: 64-byte string, unique (95.38% probably, nothing is perfect), hex encoded, representing an unique key that has been used to compute the final hash, using the `randomBytes` function from `crypto` built-in node module.
- roles: Array<"guest"|"admin">
- permissions: Array<ResourceActionScope[]>

* ResourceActionScope[] = { action: "self" | "all", method: "GET" | "POST" | "PUT" | "DELETE", resource: string = 'users' }

## Authentication & Authorization

Both the authentication and authorization are made with self-signed, RS512-based algorithm JWT that expires every 30 minutes.
All of the endpoints require authorization in one way or another, with the exception of the authentication endpoint.
Authorization is possible on endpoints by including one of the two request headers:

- Authorization: Bearer ${JWT_TOKEN}
- X-Auth-Token: ${UNIQUELY_GENERATED_KEY} - only on POST /users, one-time-only usage.

## API requests

Send the fields required in the body of the request as JSON.

## Available API routes

1. GET /users - get all users | available to users with ResourceActionScope[]{ action: "all", method: "GET", resource: "users"}

2. GET /users/:\_id - get an user by ID | available to users with ResourceActionScope[]{ action: "self" | "all", method: "GET", resource: "users"}

3. POST /users - create a new user

   #### Required fields:

   - username: not empty | unique
   - password: not empty | min. 8 characters

   #### Authorized-only fields:

   - roles
   - permissions

   #### Optional headers:

   - Authorization
   - X-Auth-Token || create a default admin user with the x-auth-token key generated on app startup.

4. PUT /users - update an existing user field.

   #### Required fields:

   - \_id

   #### Optional fields:

   - username: to modify the username
   - password: to modify the password

5. DELETE /users - delete an existing user

   #### Required fields:

   - \_id

6. POST /users/login - authentication
   ### Required fields:
   - username
   - password
7. POST /users/jwt - get user data from encoded JWT payload
   ### Required headers:
   - Authorization: Bearer ${JWT_TOKEN}
